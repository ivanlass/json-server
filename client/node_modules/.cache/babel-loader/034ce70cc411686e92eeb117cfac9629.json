{"ast":null,"code":"var _jsxFileName = \"/home/ivan/Documents/projekti2/sim-test/client/src/Components/TrialList.js\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Card from \"./Card\";\n\nfunction TrialList(props) {\n  const loggedUser = props.user;\n  const [trials, setTrials] = useState([]);\n  const [enrollment, setEnrollment] = useState([]);\n  const [enrolled, setEnrolled] = useState([]);\n  const [howManyEnrolled, setHowManyEnrolled] = useState([]);\n\n  const fetch = async (url, sets) => {\n    const result = await axios(url);\n    sets(result.data);\n  }; //Fetch trials and enrollments\n\n\n  useEffect(() => {\n    fetch(\"http://localhost:3000/Trial\", setTrials);\n    fetch(\"http://localhost:3000/Enrollment\", setEnrollment);\n  }, []); //  calculate how many are enrollments \n\n  useEffect(() => {\n    const totalCount = []; // for (let index = 0; index < enrollment.length; index++) {\n    //   for (let i = 0; i < totalCount.length; i++) {\n    //     console.log(enrollment[index])\n    //     if(totalCount[i].id === enrollment[index].trialId){\n    //       totalCount[i].count =+ 1\n    //     }else totalCount.push({id: enrollment[index].trialId, count: 1}) \n    //   }\n    // }\n\n    enrollment.map(enrolled => {\n      totalCount.map(total => {\n        if (total.id === enrollment.trialId) {\n          totalCount.count = +1;\n        } else totalCount.push({\n          id: enrollment.trialId,\n          count: 1\n        });\n      });\n    });\n    setHowManyEnrolled(totalCount);\n  }, [enrollment]); //when enrollments is fetched filter enrollments that this user participate\n  //and store in @enrolled\n\n  useEffect(() => {\n    let enrolledTrials = [];\n\n    for (let index = 0; index < enrollment.length; index++) {\n      if (enrollment[index].userId === loggedUser) {\n        enrolledTrials.push(enrollment[index].id);\n      }\n    }\n\n    setEnrolled(enrolledTrials);\n  }, [enrollment]);\n  console.log(howManyEnrolled);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }\n  }, trials.map(trial => /*#__PURE__*/React.createElement(Card, Object.assign({\n    key: trial.id\n  }, trial, {\n    isEnrolled: enrolled.includes(trial.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }))));\n}\n\nexport default TrialList;","map":{"version":3,"sources":["/home/ivan/Documents/projekti2/sim-test/client/src/Components/TrialList.js"],"names":["React","useState","useEffect","axios","Card","TrialList","props","loggedUser","user","trials","setTrials","enrollment","setEnrollment","enrolled","setEnrolled","howManyEnrolled","setHowManyEnrolled","fetch","url","sets","result","data","totalCount","map","total","id","trialId","count","push","enrolledTrials","index","length","userId","console","log","trial","includes"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,QAAjB;;AAEA,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,QAAMC,UAAU,GAAGD,KAAK,CAACE,IAAzB;AACA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBT,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACU,UAAD,EAAaC,aAAb,IAA8BX,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACY,QAAD,EAAWC,WAAX,IAA0Bb,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACc,eAAD,EAAkBC,kBAAlB,IAAwCf,QAAQ,CAAC,EAAD,CAAtD;;AAEA,QAAMgB,KAAK,GAAG,OAAOC,GAAP,EAAYC,IAAZ,KAAqB;AACjC,UAAMC,MAAM,GAAG,MAAMjB,KAAK,CAACe,GAAD,CAA1B;AACAC,IAAAA,IAAI,CAACC,MAAM,CAACC,IAAR,CAAJ;AACD,GAHD,CAPwB,CAYxB;;;AACAnB,EAAAA,SAAS,CAAC,MAAM;AACde,IAAAA,KAAK,CAAC,6BAAD,EAAgCP,SAAhC,CAAL;AACAO,IAAAA,KAAK,CAAC,kCAAD,EAAqCL,aAArC,CAAL;AACD,GAHQ,EAGN,EAHM,CAAT,CAbwB,CAmB1B;;AAGEV,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMoB,UAAU,GAAG,EAAnB,CADY,CAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAX,IAAAA,UAAU,CAACY,GAAX,CAAeV,QAAQ,IAAE;AACvBS,MAAAA,UAAU,CAACC,GAAX,CAAeC,KAAK,IAAI;AACtB,YAAGA,KAAK,CAACC,EAAN,KAAad,UAAU,CAACe,OAA3B,EAAmC;AACjCJ,UAAAA,UAAU,CAACK,KAAX,GAAkB,CAAE,CAApB;AACD,SAFD,MAEML,UAAU,CAACM,IAAX,CAAgB;AAACH,UAAAA,EAAE,EAAEd,UAAU,CAACe,OAAhB;AAAyBC,UAAAA,KAAK,EAAE;AAAhC,SAAhB;AACP,OAJD;AAKD,KAND;AAOAX,IAAAA,kBAAkB,CAACM,UAAD,CAAlB;AACH,GAlBQ,EAkBN,CAACX,UAAD,CAlBM,CAAT,CAtBwB,CA0CxB;AACA;;AACAT,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI2B,cAAc,GAAG,EAArB;;AACA,SAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGnB,UAAU,CAACoB,MAAvC,EAA+CD,KAAK,EAApD,EAAwD;AACtD,UAAInB,UAAU,CAACmB,KAAD,CAAV,CAAkBE,MAAlB,KAA6BzB,UAAjC,EAA6C;AAC3CsB,QAAAA,cAAc,CAACD,IAAf,CAAoBjB,UAAU,CAACmB,KAAD,CAAV,CAAkBL,EAAtC;AACD;AACF;;AACDX,IAAAA,WAAW,CAACe,cAAD,CAAX;AACD,GARQ,EAQN,CAAClB,UAAD,CARM,CAAT;AAUAsB,EAAAA,OAAO,CAACC,GAAR,CAAYnB,eAAZ;AACA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEIN,MAAM,CAACc,GAAP,CAAYY,KAAD,iBACT,oBAAC,IAAD;AAAM,IAAA,GAAG,EAAEA,KAAK,CAACV;AAAjB,KAAyBU,KAAzB;AAAgC,IAAA,UAAU,EAAEtB,QAAQ,CAACuB,QAAT,CAAkBD,KAAK,CAACV,EAAxB,CAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADF,CAFJ,CADF;AAQD;;AAED,eAAepB,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Card from \"./Card\";\n\nfunction TrialList(props) {\n  const loggedUser = props.user\n  const [trials, setTrials] = useState([]);\n  const [enrollment, setEnrollment] = useState([]);\n  const [enrolled, setEnrolled] = useState([]);\n  const [howManyEnrolled, setHowManyEnrolled] = useState([]);\n\n  const fetch = async (url, sets) => {\n    const result = await axios(url);\n    sets(result.data);\n  };\n\n  //Fetch trials and enrollments\n  useEffect(() => {\n    fetch(\"http://localhost:3000/Trial\", setTrials);\n    fetch(\"http://localhost:3000/Enrollment\", setEnrollment);\n  }, []);\n\n\n//  calculate how many are enrollments \n\n\n  useEffect(() => {\n      const totalCount = []\n      // for (let index = 0; index < enrollment.length; index++) {\n      //   for (let i = 0; i < totalCount.length; i++) {\n      //     console.log(enrollment[index])\n      //     if(totalCount[i].id === enrollment[index].trialId){\n      //       totalCount[i].count =+ 1\n      //     }else totalCount.push({id: enrollment[index].trialId, count: 1}) \n      //   }\n      // }\n      enrollment.map(enrolled=>{\n        totalCount.map(total => {\n          if(total.id === enrollment.trialId){\n            totalCount.count =+ 1\n          }else totalCount.push({id: enrollment.trialId, count: 1}) \n        })\n      })\n      setHowManyEnrolled(totalCount)\n  }, [enrollment]);\n\n  //when enrollments is fetched filter enrollments that this user participate\n  //and store in @enrolled\n  useEffect(() => {\n    let enrolledTrials = [];\n    for (let index = 0; index < enrollment.length; index++) {\n      if (enrollment[index].userId === loggedUser) {\n        enrolledTrials.push(enrollment[index].id);\n      }\n    }\n    setEnrolled(enrolledTrials)\n  }, [enrollment]);\n  \n  console.log(howManyEnrolled)\n  return (\n    <div>\n      {\n        trials.map((trial) => (\n          <Card key={trial.id} {...trial} isEnrolled={enrolled.includes(trial.id)}/>\n          ))}\n    </div>\n  );\n}\n\nexport default TrialList;\n"]},"metadata":{},"sourceType":"module"}