{"ast":null,"code":"var _jsxFileName = \"/home/ivan/Documents/projekti2/sim-test/client/src/Components/TrialList.js\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Card from \"./Card\";\n\nfunction TrialList(props) {\n  const loggedUser = props.user;\n  const [trials, setTrials] = useState([]);\n  const [enrolled, setEnrolled] = useState([]);\n  const [howManyEnrolled, setHowManyEnrolled] = useState([]);\n  const enrollment = props.enrollment;\n\n  const fetch = async (url, sets) => {\n    const result = await axios(url);\n    sets(result.data);\n  }; //Fetch trials\n\n\n  useEffect(() => {\n    fetch(\"http://localhost:3000/Trial\", setTrials);\n  }, []); //  calculate how many are enrollments \n\n  useEffect(() => {\n    const totalCount = [];\n    const count = {}; //extract trialId and store in @totalCount\n\n    for (let index = 0; index < enrollment.length; index++) {\n      totalCount.push(enrollment[index].trialId);\n    } //count duplicates and you get how many participants are in trials\n    //stored in @count than stored in @howManyEnrolled\n\n\n    totalCount.forEach(function (i) {\n      count[i] = (count[i] || 0) + 1;\n    });\n    setHowManyEnrolled(count);\n  }, [enrollment]); //when enrollments is fetched filter enrollments that this user participate\n  //and store in @enrolled\n\n  useEffect(() => {\n    let enrolledTrials = [];\n\n    for (let index = 0; index < enrollment.length; index++) {\n      if (enrollment[index].userId === loggedUser) {\n        enrolledTrials.push(enrollment[index].id);\n      }\n    }\n\n    setEnrolled(enrolledTrials);\n  }, [enrollment]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, trials.map(trial => /*#__PURE__*/React.createElement(Card, Object.assign({\n    key: trial.id\n  }, trial, {\n    isEnrolled: enrolled.includes(trial.id),\n    isMaxEnrolled: trial.maxPartipants >= howManyEnrolled[trial.id],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 11\n    }\n  }))));\n}\n\nexport default TrialList;","map":{"version":3,"sources":["/home/ivan/Documents/projekti2/sim-test/client/src/Components/TrialList.js"],"names":["React","useState","useEffect","axios","Card","TrialList","props","loggedUser","user","trials","setTrials","enrolled","setEnrolled","howManyEnrolled","setHowManyEnrolled","enrollment","fetch","url","sets","result","data","totalCount","count","index","length","push","trialId","forEach","i","enrolledTrials","userId","id","map","trial","includes","maxPartipants"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,QAAjB;;AAEA,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,QAAMC,UAAU,GAAGD,KAAK,CAACE,IAAzB;AACA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBT,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAACU,QAAD,EAAWC,WAAX,IAA0BX,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACY,eAAD,EAAkBC,kBAAlB,IAAwCb,QAAQ,CAAC,EAAD,CAAtD;AACA,QAAMc,UAAU,GAAGT,KAAK,CAACS,UAAzB;;AAEA,QAAMC,KAAK,GAAG,OAAOC,GAAP,EAAYC,IAAZ,KAAqB;AACjC,UAAMC,MAAM,GAAG,MAAMhB,KAAK,CAACc,GAAD,CAA1B;AACAC,IAAAA,IAAI,CAACC,MAAM,CAACC,IAAR,CAAJ;AACD,GAHD,CAPwB,CAYxB;;;AACAlB,EAAAA,SAAS,CAAC,MAAM;AACdc,IAAAA,KAAK,CAAC,6BAAD,EAAgCN,SAAhC,CAAL;AACD,GAFQ,EAEN,EAFM,CAAT,CAbwB,CAmB1B;;AACER,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMmB,UAAU,GAAG,EAAnB;AACA,UAAMC,KAAK,GAAG,EAAd,CAFY,CAGZ;;AACA,SAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGR,UAAU,CAACS,MAAvC,EAA+CD,KAAK,EAApD,EAAwD;AACtDF,MAAAA,UAAU,CAACI,IAAX,CAAgBV,UAAU,CAACQ,KAAD,CAAV,CAAkBG,OAAlC;AACD,KANW,CAOZ;AACA;;;AACAL,IAAAA,UAAU,CAACM,OAAX,CAAmB,UAASC,CAAT,EAAY;AAAEN,MAAAA,KAAK,CAACM,CAAD,CAAL,GAAW,CAACN,KAAK,CAACM,CAAD,CAAL,IAAU,CAAX,IAAgB,CAA3B;AAA8B,KAA/D;AACAd,IAAAA,kBAAkB,CAACQ,KAAD,CAAlB;AACH,GAXQ,EAWN,CAACP,UAAD,CAXM,CAAT,CApBwB,CAmCxB;AACA;;AACAb,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI2B,cAAc,GAAG,EAArB;;AACA,SAAK,IAAIN,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGR,UAAU,CAACS,MAAvC,EAA+CD,KAAK,EAApD,EAAwD;AACtD,UAAIR,UAAU,CAACQ,KAAD,CAAV,CAAkBO,MAAlB,KAA6BvB,UAAjC,EAA6C;AAC3CsB,QAAAA,cAAc,CAACJ,IAAf,CAAoBV,UAAU,CAACQ,KAAD,CAAV,CAAkBQ,EAAtC;AACD;AACF;;AACDnB,IAAAA,WAAW,CAACiB,cAAD,CAAX;AACD,GARQ,EAQN,CAACd,UAAD,CARM,CAAT;AAUA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEIN,MAAM,CAACuB,GAAP,CAAYC,KAAD,iBACT,oBAAC,IAAD;AACE,IAAA,GAAG,EAAEA,KAAK,CAACF;AADb,KAEME,KAFN;AAGE,IAAA,UAAU,EAAEtB,QAAQ,CAACuB,QAAT,CAAkBD,KAAK,CAACF,EAAxB,CAHd;AAIE,IAAA,aAAa,EAAEE,KAAK,CAACE,aAAN,IAAuBtB,eAAe,CAACoB,KAAK,CAACF,EAAP,CAJvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADF,CAFJ,CADF;AAaD;;AAED,eAAe1B,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Card from \"./Card\";\n\nfunction TrialList(props) {\n  const loggedUser = props.user\n  const [trials, setTrials] = useState([]);\n  const [enrolled, setEnrolled] = useState([]);\n  const [howManyEnrolled, setHowManyEnrolled] = useState([]);\n  const enrollment = props.enrollment;\n\n  const fetch = async (url, sets) => {\n    const result = await axios(url);\n    sets(result.data);\n  };\n\n  //Fetch trials\n  useEffect(() => {\n    fetch(\"http://localhost:3000/Trial\", setTrials);\n  }, []);\n\n\n\n//  calculate how many are enrollments \n  useEffect(() => {\n      const totalCount = []\n      const count = {};\n      //extract trialId and store in @totalCount\n      for (let index = 0; index < enrollment.length; index++) {\n        totalCount.push(enrollment[index].trialId)\n      }\n      //count duplicates and you get how many participants are in trials\n      //stored in @count than stored in @howManyEnrolled\n      totalCount.forEach(function(i) { count[i] = (count[i]||0) + 1;});\n      setHowManyEnrolled(count)\n  }, [enrollment]);\n\n\n\n  //when enrollments is fetched filter enrollments that this user participate\n  //and store in @enrolled\n  useEffect(() => {\n    let enrolledTrials = [];\n    for (let index = 0; index < enrollment.length; index++) {\n      if (enrollment[index].userId === loggedUser) {\n        enrolledTrials.push(enrollment[index].id);\n      }\n    }\n    setEnrolled(enrolledTrials)\n  }, [enrollment]);\n  \n  return (\n    <div>\n      {\n        trials.map((trial) => (\n          <Card \n            key={trial.id} \n            {...trial} \n            isEnrolled={enrolled.includes(trial.id)}\n            isMaxEnrolled={trial.maxPartipants >= howManyEnrolled[trial.id]}  \n          />\n          ))}\n    </div>\n  );\n}\n\nexport default TrialList;\n"]},"metadata":{},"sourceType":"module"}